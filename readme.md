# 2025.2.9

- 在代码中增加了自动获取ip地址的功能，现在可以省去部署步骤中的第一步，也不用每次到一个新的网络环境中都重新打包了，但是还是要在手机中增加新的规则；

# 简介

- 参考博客：https://segmentfault.com/a/1190000042388968
- 原理：将手机上微信的消息通知通过网络发送到本机ip的某个端口上，在电脑上用python程序监听这个端口，将监听到的信息在桌面以弹窗展示；
- 优化了原博客中代码的两个小功能：群聊名称无法显示、两个时间接近的消息弹窗切换太丑陋；

# 部署步骤

1. 将源代码中的ip地址和端口号改成自己的；
2. 在手机中的短信转发软件中新增或修改之前的规则；
3. 安卓15系统中增加了增强通知的功能，需要关闭掉，不然部分通知无法显示出来，方法可参考https://zhuanlan.zhihu.com/p/7748674777；
4. 由于DHCP动态路由协议，电脑的ip地址在同一个无线局域网也是会变化的，可以手动设置固定使用一个ip地址，方法可参考：（来自kimi）
   1. **打开网络和共享中心**：
      - 点击任务栏右下角的网络图标，选择“打开网络和共享中心”。
   2. **更改适配器设置**：
      - 在网络和共享中心，点击左侧的“更改适配器设置”。
   3. **选择网络适配器**：
      - 找到正在使用的网络适配器（例如“无线网络连接”或“以太网”），右键点击并选择“属性”。
   4. **设置IPv4属性**：
      - 在适配器属性窗口中，双击“Internet协议版本4（TCP/IPv4）”。 . **输入固定IP信息**：
      - 在弹出的窗口中，选择“使用下面的IP地址”，并输入以下信息：
        - **IP地址**：根据你的网络环境，输入一个未被使用的IP地址。
        - **子网掩码**：通常为`255.255.255.0`。
        - **默认网关**：通常是路由器的IP地址，例如`192.168.1.1`。
        - **DNS服务器**：可以使用路由器提供的DNS服务器地址，或者使用公共DNS服务器（如`8.8.8.8`和`8.8.4.4`）。
5. 设置开机自启动。我用的方法是把代码打包成可执行文件，然后将可执行文件的快捷方式放入shell:startup启动文件夹中；

```shell
pip install pyinstaller
pyinstaller --onefile --windowed wechatInform.py
```

# 不足

- 依赖于手机的消息转发，实现方法有些丑陋和不方便；
- 电脑和手机必须在同一个WLAN中；
- 在新的网络环境中需要重新部署，有时间可以写一个前端，支持手动输入ip和端口号；
- 受限于本人技术力，还有很多可以改进的地方，望有后来人…